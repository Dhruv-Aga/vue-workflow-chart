pipeline:
  tests:
    image: node:8
    commands:
      - yarn
      - yarn run lint
      - yarn run test:unit
  sonar:
    image: newtmitch/sonar-scanner
    commands:
      - echo $PWD
      - sonar-scanner -Dsonar.projectKey=$${SONAR_PROJECT_KEY} -Dsonar.organization=$${SONAR_ORGANIZATION} -Dsonar.sources=. -Dsonar.host.url=$${SONAR_HOST} -Dsonar.login=$${SONAR_LOGIN}
    secrets: [SONAR_HOST, SONAR_LOGIN, SONAR_ORGANIZATION, SONAR_PROJECT_KEY]
    when:
      event: push
